<!DOCTYPE html>

<html>

  <head>
   <meta charset="UTF-8">
   <title>KeepUpsGame</title>

    <style type="text/css"> 
	
	  canvas { 
        border: 1px solid black;
		padding: 0;
		margin:105px 0 0 275px ;
		display: block;
		width: 800px;
		background-color: white;
      }
	  
	</style>
	
  </head>
  
  <body background = "background.jpg">
	<canvas id="game-canvas" height="400" width="700"></canvas>
	
    <script type="text/javascript"> 
	  // Gets a handle to the element with id canvasOne.
      var canvas = document.getElementById("game-canvas"); 
      // Get a 2D context for the canvas.
      var ctx = canvas.getContext("2d");
	  
	  var score=0;
	  var over=0;
	  
	  var doubleScore=0;
	  var biggerPaddle=0;
	  var minusScore=0;
	  
	  var randomTimeDoubleScore;
	  var randomTimeBiggerPaddle;
	  var randomTimeMinusScore;
	  
	  var drawDoubleScore=0;
	  var drawBiggerPaddle=0;
	  var drawMinusScore=0;
	  
	  var canDrawCircle=1;
	  var canDrawBigPaddle=1;
	  var canDrawMinusScore=1;
	  
	  var executeBigPaddleOnce=0;
	  var executeMinusScoreOnce=0;
	  
	  // An object for the ball.
		var ball = {
			position: {x: 1, y: 50}
			, radius: 5
			, velocity: {x: 3, y: 3}
			, acceleration: {x: 0, y: 0.1}
		}
		
		var rectangle = {
			position: {x: 300, y: 370}
			, width: 20
			, length: 100
		}
		
		var doubleScoreCircle = {
			position: {x: 999, y: 999}
			, radius: 20
		}
		
		var biggerPaddleCircle = {
			position: {x: 999, y: 999}
			, radius: 20
		}
		
		var minusScoreCircle = {
			position: {x: 999, y: 999}
			, radius: 10
		}
		 
		 
		 while((doubleScoreCircle.position.x >= canvas.width - doubleScoreCircle.radius) ||  (doubleScoreCircle.position.x <= doubleScoreCircle.radius))
		 {
			doubleScoreCircle.position.x = Math.floor((Math.random() * 600 + 1));
			console.log("doubleScoreCircle x: " + doubleScoreCircle.position.x);
		 }
		 
		 while ((doubleScoreCircle.position.y >= canvas.height - doubleScoreCircle.radius) ||  (doubleScoreCircle.position.y <= doubleScoreCircle.radius))
		 {
			 doubleScoreCircle.position.y = Math.floor((Math.random() * 150 + 1));
			console.log("doubleScoreCircle y: " + doubleScoreCircle.position.y);
		 }
		 
		 while((biggerPaddleCircle.position.x >= canvas.width - biggerPaddleCircle.radius) ||  (biggerPaddleCircle.position.x <= biggerPaddleCircle.radius))
		 {
			biggerPaddleCircle.position.x = Math.floor((Math.random() * 600 + 1));
			console.log("biggerPaddleCircle x: " + biggerPaddleCircle.position.x);
		 }
		 
		 while ((biggerPaddleCircle.position.y >= canvas.height - biggerPaddleCircle.radius) ||  (biggerPaddleCircle.position.y <= biggerPaddleCircle.radius))
		 {
			biggerPaddleCircle.position.y = Math.floor((Math.random() * 150 + 1));
			console.log("biggerPaddleCircle y: " + biggerPaddleCircle.position.y);
		 }
		 
		 while((minusScoreCircle.position.x >= canvas.width - minusScoreCircle.radius) ||  (minusScoreCircle.position.x <= minusScoreCircle.radius))
		 {
			minusScoreCircle.position.x = Math.floor((Math.random() * 600 + 1));
			console.log("minusScoreCircle x: " + minusScoreCircle.position.x);
		 }
		 
		 while ((minusScoreCircle.position.y >= canvas.height - minusScoreCircle.radius) ||  (minusScoreCircle.position.y <= minusScoreCircle.radius))
		 {
			minusScoreCircle.position.y = Math.floor((Math.random() * 150 + 1));
			console.log("minusScoreCircle y: " + minusScoreCircle.position.y);
		 }
		 
		 while (ball.position.x < 3)
		 {
			ball.position.x = Math.floor((Math.random() * 690 + 1));
		 }
		 
		 randomTimeDoubleScore = Math.floor((Math.random() * 5000 + 5000));
		// console.log("generated random time" + randomTimeDoubleScore);
		 
		 randomTimeBiggerPaddle = Math.floor((Math.random() * 5000 + 15000));
		// console.log("generated random time" + randomTimeBiggerPaddle);
		 
		 randomTimeMinusScore = Math.floor((Math.random() * 5000 + 25000));
		 console.log("generated random time minus" + randomTimeMinusScore);
		
		function drawCircle() {
			ctx.fillStyle = "rgb(0, 0, 255)";
			ctx.beginPath();
			ctx.arc(ball.position.x, ball.position.y, ball.radius, 0, 2 * Math.PI);
			ctx.fill();
		}
		
		function drawDoubleScoreCircle() {
			ctx.fillStyle = "rgb(0, 255, 0)";
			if(doubleScore == 1)
			{
				ctx.fillStyle = "rgb(255, 255, 255)";
			}
			ctx.beginPath();
			ctx.arc(doubleScoreCircle.position.x, doubleScoreCircle.position.y, doubleScoreCircle.radius, 0, 2 * Math.PI);
			ctx.fill();
		//	console.log("doubleScore drawn");
		}
		
		function drawBiggerPaddleCircle() {
			ctx.fillStyle = "rgb(255, 150, 0)";
			if(biggerPaddle == 1)
			{
				ctx.fillStyle = "rgb(255, 255, 255)";
			}
			ctx.beginPath();
			ctx.arc(biggerPaddleCircle.position.x, biggerPaddleCircle.position.y, biggerPaddleCircle.radius, 0, 2 * Math.PI);
			ctx.fill();
			//console.log("bigger paddle drawn");
		}
		
		function drawMinusScoreCircle() {
			ctx.fillStyle = "rgb(255, 0, 0)";
			if(minusScore == 1)
			{
				ctx.fillStyle = "rgb(255, 255, 255)";
			}
			ctx.beginPath();
			ctx.arc(minusScoreCircle.position.x, minusScoreCircle.position.y, minusScoreCircle.radius, 0, 2 * Math.PI);
			ctx.fill();
			console.log("minus score drawn");
		}
		
		function drawRect() {
			ctx.fillStyle = "rgb(170, 170, 170)";
			ctx.beginPath();
			ctx.rect(rectangle.position.x,rectangle.position.y,rectangle.length,rectangle.width);
			ctx.fill();
			//console.log("drew Rect");
		}
		
		function gameOver()
		{
			ctx.clearRect(0, 0, canvas.width, canvas.height);
			ctx.fillStyle = "black";
			ctx.font = "22px Arial";
			ctx.clearRect(0, 0, canvas.width, canvas.height);
			ctx.fillText("Game Over ", 280, 200);
			ctx.fillText("Your Score Was: " + score, 260, 230);
			over = 1;
			window.removeEventListener("keydown", moveevent);
		}
		
		function collideWithRect() {
			if (ball.position.x + ball.radius < rectangle.position.x || ball.position.x - ball.radius > rectangle.position.x + rectangle.length)
				return;
			
			else if (ball.position.y + ball.radius < rectangle.position.y)
				return;
			
			else{
				ball.velocity.y = -ball.velocity.y;
				if(doubleScore == 0)
				{
					score++;
				}
				if(doubleScore == 1)
				{
					score = score+2;
				}
				if(biggerPaddle == 0)
				{
					return;
				}
				
				
				if(score != 0 && score % 5 == 0){
					if(ball.velocity.y < 0)
						ball.velocity.y -= 0.5;
						
					if(ball.velocity.y > 0)
						ball.velocity.y += 0.5;
						
					if(ball.velocity.x < 0)
						ball.velocity.x -= 0.5;
						
					if(ball.velocity.x > 0)
						ball.velocity.x += 0.5;
				}
			}	
		}
		
		function collideWithDoubleScoreCircle() {	
			  var dx = (ball.position.x ) - (doubleScoreCircle.position.x );
              var dy = (ball.position.y ) - (doubleScoreCircle.position.y );
              var distance = Math.sqrt(dx * dx + dy * dy);
			  
              if (distance < ball.radius + doubleScoreCircle.radius & canDrawCircle == 0) {                      
                  doubleScore=1;       
              } 
		}
		
		function collideWithBigPaddleCircle() {	
			  var dx = (ball.position.x ) - (biggerPaddleCircle.position.x );
              var dy = (ball.position.y ) - (biggerPaddleCircle.position.y );
              var distance = Math.sqrt(dx * dx + dy * dy);
			  
              if (distance < ball.radius + biggerPaddleCircle.radius & canDrawBigPaddle == 0) {                      
                  biggerPaddle = 1;
              }
			  
			if(biggerPaddle == 1 && executeBigPaddleOnce == 0)
			{
				executeBigPaddleOnce=1;
				rectangle.length = rectangle.length + 25;
			}
		}
		
		function collideWithMinusScoreCircle() {	
			  var dx = (ball.position.x ) - (minusScoreCircle.position.x );
              var dy = (ball.position.y ) - (minusScoreCircle.position.y );
              var distance = Math.sqrt(dx * dx + dy * dy);
			  
              if (distance < ball.radius + minusScoreCircle.radius & canDrawMinusScore == 0) {                      
                  minusScore = 1;
              }
			  
			if(minusScore == 1 && executeMinusScoreOnce == 0)
			{
				executeMinusScoreOnce=1;
				
				if(score >= 5){
					score= score-5;
				}
			}
		}
				
		function canDrawBonusCircle() {
			canDrawCircle=0;
		}
		
		function canDrawBiggerPaddle() {
			canDrawBigPaddle=0;
		}
		
		function canDrawMinusScores() {
			canDrawMinusScore=0;
		}
	
		function moveBall() {
			ctx.clearRect(0, 0, canvas.width, canvas.height);
		
			if(drawDoubleScore == 0)
			{
				drawDoubleScore=1;
				setTimeout(canDrawBonusCircle, randomTimeDoubleScore);
				//console.log("time out set");
			}
			
			if(drawBiggerPaddle == 0)
			{
				drawBiggerPaddle=1;
				setTimeout(canDrawBiggerPaddle, randomTimeBiggerPaddle); //not sure about this
				//console.log("time out set");
			}
			
			if(drawMinusScore == 0)
			{
				drawMinusScore=1;
				setTimeout(canDrawMinusScores, randomTimeMinusScore); //not sure about this
				console.log("time out set minus");
			}
			
			if(canDrawCircle == 0)
			{
				drawDoubleScoreCircle();
			}
			
			if(canDrawBigPaddle == 0)
			{
				drawBiggerPaddleCircle();
			}
			
			if(canDrawMinusScore == 0)
			{
				drawMinusScoreCircle();
			}
			//drawDoubleScoreCircle();
			//drawBiggerPaddleCircle();
			//draw circle
			drawCircle();
			
			//draw rectangle
			drawRect();
			
			
			//score();
			
			// Update the y location.
			ball.position.x += ball.velocity.x;
			ball.position.y += ball.velocity.y;
			
			// Keep the animation going while the ball has not touched the canvas bottom.
			if ((ball.position.x >= canvas.width - ball.radius) ||  (ball.position.x <= ball.radius))
			  ball.velocity.x = -ball.velocity.x;    
			if ((ball.position.y >= canvas.height - ball.radius) ||  (ball.position.y <= ball.radius))
			  ball.velocity.y = -ball.velocity.y;
			  
			if(ball.position.y  > rectangle.position.y + 10)
			{	
				//call game over function
				gameOver();
			}
			  
			  collideWithRect();
			  collideWithDoubleScoreCircle();
			  collideWithBigPaddleCircle();
			  collideWithMinusScoreCircle();
			  
				ctx.fillStyle = "black";
				ctx.font = "18px Arial";
				ctx.fillText("Score: " + score, 10, 20);
			
			if (!over)
				window.requestAnimationFrame(moveBall);
		  }
			
			window.requestAnimationFrame(moveBall);
		
		
		function moveevent(event) { 
			ctx.clearRect(0, 0, canvas.width, canvas.height);
			
			if (event.keyCode == 39 && rectangle.position.x + rectangle.length < canvas.width)
			  rectangle.position.x += 10;
			else if (event.keyCode == 37 && rectangle.position.x > 0)
			  rectangle.position.x -= 10; 
		}
		
		// Add an event listener to the keypress event.
		  window.addEventListener("keydown", moveevent);

	</script>
	
  </body>
  
</html>