<!DOCTYPE html>

<html>

  <head>
   <meta charset="UTF-8">
   <title>KeepUpsGame</title>

    <style type="text/css"> 
	
	  canvas { 
        border: 1px solid black;
		padding: 0;
		margin:105px 0 0 275px ;
		display: block;
		width: 800px;
		background-color: white;
      }
	  
	</style>
	
  </head>
  
  <body background = "background.jpg">
	<canvas id="game-canvas" height="400" width="700"></canvas>
	
    <script type="text/javascript"> 
	  // Gets a handle to the element with id canvasOne.
      var canvas = document.getElementById("game-canvas"); 
      // Get a 2D context for the canvas.
      var ctx = canvas.getContext("2d");
	  
	  var score=0;
	  var over=0;
	  
	  // An object for the ball.
      var ball = {
        position: {x: 200, y: 50}
        , radius: 5
        , velocity: {x: 3, y: 3}
		, acceleration: {x: 0, y: 0.1}
		}
		
		 ball.position.x = Math.floor((Math.random() * 690 + 1));
		 console.log(ball.position.x);
		 
		 if (ball.position.x < 3)
		 {
			ball.position.x = Math.floor((Math.random() * 690 + 1));
		 }
		  
		
	  var rectangle = {
        position: {x: 300, y: 370}
        , width: 20
        , length: 100
		}
		
		function drawCircle() {
			ctx.fillStyle = "rgb(0, 0, 255)";
			ctx.beginPath();
			ctx.arc(ball.position.x, ball.position.y, ball.radius, 0, 2 * Math.PI);
			ctx.fill();
		}
		
		function drawRect() {
			ctx.fillStyle = "rgb(170, 170, 170)";
			ctx.beginPath();
			ctx.rect(rectangle.position.x,rectangle.position.y,rectangle.length,rectangle.width);
			ctx.fill();
		}
		
		function gameOver()
		{
			ctx.clearRect(0, 0, canvas.width, canvas.height);
			ctx.fillStyle = "black";
			ctx.font = "18px Arial";
			ctx.fillText("Game Over ", 300, 200);
			shutdown();
		}
		
		function collideWithRect() {
			if (ball.position.x + ball.radius < rectangle.position.x || ball.position.x - ball.radius > rectangle.position.x + rectangle.length)
				return;
			
			else if (ball.position.y + ball.radius < rectangle.position.y)
				return;
			
			else{
				ball.velocity.y = -ball.velocity.y;
				score++;
				if(score != 0 && score % 5 == 0){
					if(ball.velocity.y < 0)
						ball.velocity.y -= 0.5;
						
					if(ball.velocity.y > 0)
						ball.velocity.y += 0.5;
						
					if(ball.velocity.x < 0)
						ball.velocity.x -= 0.5;
						
					if(ball.velocity.x > 0)
						ball.velocity.x += 0.5;
				}
			}	
		}
	
	  function moveBall() {
		ctx.clearRect(0, 0, canvas.width, canvas.height);
		
		//draw circle
		drawCircle();
		
		//draw rectangle
		drawRect();
		
		//score();
		
		// Update the y location.
		ball.position.x += ball.velocity.x;
        ball.position.y += ball.velocity.y;
		
		// Keep the animation going while the ball has not touched the canvas bottom.
        if ((ball.position.x >= canvas.width - ball.radius) ||  (ball.position.x <= ball.radius))
          ball.velocity.x = -ball.velocity.x;    
		if ((ball.position.y >= canvas.height - ball.radius) ||  (ball.position.y <= ball.radius))
          ball.velocity.y = -ball.velocity.y;
		  
		if(ball.position.y  > rectangle.position.y + 10)
		{	
			//call game over function
			gameOver();
		}
		  
		  collideWithRect();
		  
			ctx.fillStyle = "black";
			ctx.font = "18px Arial";
			ctx.fillText("Score: " + score, 10, 20);
		
        window.requestAnimationFrame(moveBall);
      }
		
		window.requestAnimationFrame(moveBall);
		
	// Add an event listener to the keypress event.
	if(over == 0)
	{
      window.addEventListener("keydown", function(event) { 
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        if (event.keyCode == 39 && rectangle.position.x + rectangle.length < canvas.width)
          rectangle.position.x += 10;
        else if (event.keyCode == 37 && rectangle.position.x > 0)
          rectangle.position.x -= 10;
		 
      });
	  }

    </script>

	
  </body>
  
</html>